<!DOCTYPE html>
<html><head>
<title>被迫学习之拓展欧几里得算法 &amp; 高斯消元</title>

<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">




<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-111347233-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



<script src="/vendor/js/jquery.min.js" ></script>
<script src="/vendor/js/popper.min.js" ></script>
<script src="/vendor/js/bootstrap.min.js" ></script>
<script src="/vendor/js/smooth-scroll.polyfills.min.js" ></script>
<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">
<script src="/vendor/js/vue.min.js" ></script>




<link rel="stylesheet" href="https://kirainmoe.com/scss/journal.min.d1b323a5bdb0e7b05730834eb664c761432cfb57d618b4efeb5a9417a66a4b44.css" integrity="sha256-0bMjpb2w57BXMINOtmTHYUMs&#43;1fWGLTv61qUF6ZqS0Q=" media="screen">

<script src="https://kirainmoe.com//js/loadCSS.js"></script>
<script src="https://kirainmoe.com//js/table.js"></script>


<script src="https://kirainmoe.com//js/toc.js"></script>


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      showProcessingMessages: false,
      messageStyle: "none", 
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [["$", "$"], ["\\(", "\\)"]],
        displayMath: [["$$", "$$"], ["\\[", "\\]"]],
        skipTags: ["script", "noscript", "style", "textarea", "pre", "code", "a"]
      },
      "HTML-CSS": {
        availableFonts: ["STIX", "TeX"], 
        showMathMenu: false
      }
  });
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script src="https://unpkg.com/muse-player/dist/assets/muse-player.js"></script>

<script>
    loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons");
</script>

</head><body>
    	<div id="app"><div ref="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://kirainmoe.com/">
    
        <div class="nav-title">
            宇宙よりも遠い場所
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
                
                
                <a class="a-block nav-link-item false" href="/pages/guestbook">
                    留言板
                </a>
        
            
                
                
                <a class="a-block nav-link-item false" href="/pages/friends">
                    友情链接
                </a>
        
            
                
                
                <a class="a-block nav-link-item false" href="/tags">
                    标签
                </a>
        
            
                
                
                <a class="a-block nav-link-item false" href="/pages/about">
                    关于
                </a>
        
    </div>

    

    <div class="nav-footer">
        &copy;
	
	2016-2020 宇宙よりも遠い場所
	

/

<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC-BY-SA 4.0</a>

<br>

Published with <a href="https://gohugo.io">Hugo</a> / Theme <a href="https://github.com/amazingrise/hugo-theme-diary" title="Author: Rise @ amazingrise.net">Diary</a>

    </div>

    
    <script src="https://tj.kirainmoe.com/cgi-bin/inject_script.cgi"></script>
    
</div><div ref="extraContainer" class="extra-container">
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e6%8b%93%e5%b1%95%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95-exgcd" v-on:click="closeDrawer" id="拓展欧几里得算法-exgcd-nav">
										 拓展欧几里得算法 (exgcd)
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83" v-on:click="closeDrawer" id="高斯消元-nav">
										 高斯消元
									</a>
								</li>
						
							</ul>
						
					
				
			
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
    </div>
</div><div class="single-column-drawer-container" ref="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
                
                    
                    
                    <a class="a-block drawer-menu-item false" href="/pages/guestbook">
                        留言板
                    </a>
            
                
                    
                    
                    <a class="a-block drawer-menu-item false" href="/pages/friends">
                        友情链接
                    </a>
            
                
                    
                    
                    <a class="a-block drawer-menu-item false" href="/tags">
                        标签
                    </a>
            
                
                    
                    
                    <a class="a-block drawer-menu-item false" href="/pages/about">
                        关于
                    </a>
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e6%8b%93%e5%b1%95%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95-exgcd" v-on:click="closeDrawer" id="拓展欧几里得算法-exgcd-nav">
										 拓展欧几里得算法 (exgcd)
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83" v-on:click="closeDrawer" id="高斯消元-nav">
										 高斯消元
									</a>
								</li>
						
							</ul>
						
					
				
			
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav ref="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div ref="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a ref="navTitle" class="navbar-brand" href="https://kirainmoe.com/">
            宇宙よりも遠い場所
        </a>
    </div>
</nav>
<div class="single-column-header-container" ref="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://kirainmoe.com/">
        <div class="single-column-header-title">宇宙よりも遠い場所</div>
        

    </a>
</div>
            <div id="content">
<div ref="streamContainer" class="stream-container">
    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                 style="background-image: url('/')">
                <div class="post-title">
                    被迫学习之拓展欧几里得算法 &amp; 高斯消元
                    <div class="post-meta">
                        <time itemprop="datePublished">
                            2018-07-27 20:43
                        </time>

                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/algorithm">algorithm</a>
                                &nbsp;
                            
                                <a href="/tags/math">math</a>
                                &nbsp;
                            
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                <div class="post-body">
                    <p>为了在我自己什么都不会的背景下给 OI 队学弟学妹写材料，“被迫”去翻出书本和课件，重新啃了数论的内容学这两个东西……（发出退役咸鱼的声音</p>

<h1 id="拓展欧几里得算法-exgcd">拓展欧几里得算法 (exgcd)</h1>

<p>对于不全为 \(0\) 的非负整数 \(a, b\)，\(gcd(a, b)\) 表示 \(a, b\) 的最大公约数，则<strong>必然存在整数对 \(x, y\) ，使得 \(gcd(a, b)= ax + by\)</strong>。</p>

<p>比如 \(a = 3, b = 5\) 的时候，\(gcd(a, b) = 1\), 那么有 \(x, y\) 的一组解为 \(x = 2, y = -1\) 使得 \(ax + by = 6 - 5 = 1 = gcd(a, b)\).</p>

<p>拓展欧几里得算法就是用来求解 x, y 的。那么它是如何做到的？现在我们已知一组非负整数 \(a, b (a \geq b)\):</p>

<ol>
<li><p>显然当 \(b = 0\) 的时候，\(gcd(a, b) = a\)，此时容易知道当 \(x = 1, y = 0\) 时为一组解。</p></li>

<li><p>否则，当 \(a &gt; b &gt; 0\) 的时候，设 \(ax\_{1} + by\_{1} = gcd(a, b)\)</p></li>

<li><p>那么有 \(bx_{2} + (a \mod b) \cdot y_{2} = gcd(b, a \mod b)\)</p></li>

<li><p>根据欧几里得原理，容易知道 \(gcd(a, b) = gcd(b, a \mod b)\)；</p></li>

<li><p>从而 \(ax_{1} + by_{1} = bx_{2} + (a \mod b) \cdot y_{2}\),</p></li>

<li><p>有 \(ax_{1} + by_{1} = bx_{2} + (a - [a \div b] \cdot b) \cdot y_{2} = ay_{2} + bx_{2} - [a \div b] \times by_{2}\), 其中 \([]\) 表示向下取整符号。</p></li>

<li><p>消去系数，最后求得 \(x_{1}  = y_{2}\), \(y_{1} = x_{2} - [a \div b]y_{2}\).</p></li>
</ol>

<p>我们得到了 \(x1, y1\) 和 \(x2, y2\) 的关系，也就是 \(x1, y1\) 可以由 \(x2, y2\) 表示。其中 \(x2, y2\) 是 \(bx + (a \mod b)y = gcd(b, a \mod b)\) 的一组解。但我们两组解都不知道，此时我们可以倒回去推。</p>

<p>可以证明在求解 \(gcd(a, b)\) 的递归过程中最后 \(b\) 一定等于 0, 此时 \(x = 1, y = 0\), 然后我们可以据此倒着推回去。</p>

<hr />

<p>如求解 \(exgcd(6, 4)\), 即求使 \(6x + 4y = gcd(6, 4) = 2\) 成立的 \(x, y\)，</p>

<p>由 \(gcd(6, 4) = gcd(4, 2)\)  得当 \(a&rsquo; = 4, b&rsquo; = 2\) 时，\(a&rsquo;x&rsquo; + b&rsquo;y&rsquo; = gcd(4, 2) = 2\)，根据上面的推断式不难得到 \(x = y&rsquo;, y = x&rsquo; - [6 \div 4]y&rsquo;\)</p>

<p>由 \(gcd(4, 2) = gcd(2, 0)\) 得当 \(a&rdquo; = 2, b&rdquo; = 0\) 时，\(a&rdquo;x&rdquo; + b&rdquo;y&rdquo; = gcd(2, 0) = 2\)，此时由于 \(b&rdquo; = 0\)，可得 \(x&rdquo; = 1, y&rdquo; = 0\).</p>

<p>再由上面的推断式 \(x&rsquo; = y&rdquo;, y&rsquo; = x&rdquo; - [4 \div 2]y&rdquo;\)，代入 \(x&rdquo;, y&rdquo;\) 得到 \(x&rsquo; = 0, y&rsquo; = 1 - 2 \times 0 = 1\)</p>

<p>最后把 \(x&rsquo; = 0, y&rsquo; = 1\) 代入 \(x = y&rsquo;, y = x&rsquo; - [6 \div 4]y&rsquo;\) 得到 \(x = 1, y = 0 - 1 \times 1 = -1\).</p>

<p>将 \(x = 1, y = -1\) 代入 \(6x + 4y = gcd(6, 4) = 2\)，此组解有效。</p>

<hr />

<p>可以看到我们的求解过程是层层递归的，我们利用欧几里得定理，不断让 \(a&rsquo; = b, b&rsquo; = a \mod b\)，直到 \(b = 0\) 得到 \(x = 1, y = 0\)，再用这个 \(x, y\) 层层回溯根据推导式，计算出上一层的 \(x, y\) 直到得到结果。明白了这样的思想之后，我们就可以像下面这样实现拓展欧几里得算法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> x, y, a, b;

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">exgcd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
    <span style="color:#66d9ef">if</span> (b <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) {
        x <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
        y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        <span style="color:#66d9ef">return</span>;
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">// x = y&#39;, y = x&#39; - [a / b] * y&#39;
</span><span style="color:#75715e"></span>        exgcd(b, a <span style="color:#f92672">%</span> b);
        <span style="color:#66d9ef">int</span> tmp <span style="color:#f92672">=</span> y;
        y <span style="color:#f92672">=</span> x <span style="color:#f92672">-</span> (a <span style="color:#f92672">/</span> b) <span style="color:#f92672">*</span> y;
        x <span style="color:#f92672">=</span> tmp;
    }
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    a <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
    exgcd(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>);
    std<span style="color:#f92672">:</span><span style="color:#f92672">:</span>cout <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> x <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74"> </span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> y;
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div>
<p>输出：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-markdown" data-lang="markdown">1 -1</code></pre></div>
<p>有时候，exgcd 可以简化如下, 其中 <code>d = gcd(a, b)</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">exgcd</span> (<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b, <span style="color:#66d9ef">int</span> <span style="color:#f92672">&amp;</span>d, <span style="color:#66d9ef">int</span> <span style="color:#f92672">&amp;</span>x, <span style="color:#66d9ef">int</span> <span style="color:#f92672">&amp;</span>y) {
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>b) {
        d <span style="color:#f92672">=</span> a, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    } <span style="color:#66d9ef">else</span> {
        exgcd(b, a <span style="color:#f92672">%</span> b, d, y, x);       <span style="color:#75715e">// 注意 x,y 的顺序
</span><span style="color:#75715e"></span>        y <span style="color:#f92672">-</span><span style="color:#f92672">=</span> x <span style="color:#f92672">*</span> (a <span style="color:#f92672">/</span> b);               <span style="color:#75715e">// 原理与上文相同
</span><span style="color:#75715e"></span>    }
}
</code></pre></div>
<p>显然，我们求出的这个 x, y 可能是不唯一的。出现多解原因在于我们规定当 \(b = 0\) 的时候 \(y = 0\)，实际上此时 \(y\) 可以取任何整数。</p>

<p>那么这个算法有什么卵用？它可以用来解二元一次的不定方程。对于不定方程 \(ax + by = c\)，设 \(gcd(a, b) = d\)，如果 \(ax + by = c\) 有解，那么 \(d\) 是 \(c\) 的约数，即 \(d|c, c = n \cdot d\) （充分必要条件）.</p>

<p>那么我们只要先求出 \(ax&rsquo; + by&rsquo; = gcd(a, b) = d\) 的 \(x&rsquo;, y&rsquo;\)，分别对 \(x&rdquo;, y\) 乘 \(\frac{c}{d}\) 倍即可。或者，我们可以让 \(b = 0\) 时的 exgcd 结果为 \(\frac{c}/{d}\) ，这样一遍 exgcd 跑完之后的 x, y 就是方程的解了。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">int</span> a, b, x, y, c;      <span style="color:#75715e">// ax+by = c
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">exgcd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
    <span style="color:#66d9ef">if</span> (b <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) {
        x <span style="color:#f92672">=</span> c <span style="color:#f92672">/</span> a, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;        <span style="color:#75715e">// 当 b&#39; = 0时，a&#39; = gcd(a, b)
</span><span style="color:#75715e"></span>    } <span style="color:#66d9ef">else</span> {
        exgcd(b, a <span style="color:#f92672">%</span> b);
        <span style="color:#66d9ef">int</span> tmp <span style="color:#f92672">=</span> y;
        y <span style="color:#f92672">=</span> x <span style="color:#f92672">-</span> (a <span style="color:#f92672">/</span> b) <span style="color:#f92672">*</span> y;
        x <span style="color:#f92672">=</span> tmp;
    }
}
</code></pre></div>
<p>因为 exgcd 所求得的 x, y 可以不唯一，而有些题目要求我们输出符合某些条件的解，所以我们还可以对求得的最终结果加以限定条件。例如题目要求 x &lt; 某一个特定的数 p 时：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">y <span style="color:#f92672">=</span> x <span style="color:#f92672">-</span> (a <span style="color:#f92672">/</span> b) <span style="color:#f92672">*</span> y;
x <span style="color:#f92672">=</span> tmp;
<span style="color:#75715e">// ------
</span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (x <span style="color:#f92672">&gt;</span> p) {
    <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> x <span style="color:#f92672">/</span> p;      <span style="color:#75715e">// 求 x 是 p 的多少倍
</span><span style="color:#75715e"></span>    x <span style="color:#f92672">-</span><span style="color:#f92672">=</span> t <span style="color:#f92672">*</span> p;         <span style="color:#75715e">// 从 x 中减去 tp
</span><span style="color:#75715e"></span>    y <span style="color:#f92672">+</span><span style="color:#f92672">=</span> t <span style="color:#f92672">*</span> p <span style="color:#f92672">*</span> a <span style="color:#f92672">/</span> b;     <span style="color:#75715e">// 根据 ax+by=c, a(x-tp) + b(y+k) = c, 得 -atp+bk = 0, k = tpa/b
</span><span style="color:#75715e"></span>}
</code></pre></div>
<p>或者，求最小正整数解，参考 <a href="https://blog.csdn.net/qq_20200047/article/details/71159677：">https://blog.csdn.net/qq_20200047/article/details/71159677：</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">if</span> (c <span style="color:#f92672">%</span> d <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) {
    x <span style="color:#f92672">*</span><span style="color:#f92672">=</span> c <span style="color:#f92672">/</span> d;
    <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> b <span style="color:#f92672">/</span> d;
    x <span style="color:#f92672">=</span> (x <span style="color:#f92672">%</span> t <span style="color:#f92672">+</span> t) <span style="color:#f92672">%</span> t;        <span style="color:#75715e">// x
</span><span style="color:#75715e"></span>    y <span style="color:#f92672">=</span> (c <span style="color:#f92672">-</span> (a <span style="color:#f92672">*</span> x)) <span style="color:#f92672">/</span> b;      <span style="color:#75715e">// y
</span><span style="color:#75715e"></span>}
</code></pre></div>
<h1 id="高斯消元">高斯消元</h1>

<p>高斯消元法是用来解线性规划（线性方程组）的算法。</p>

<p>高斯消元的思想和我们解多元方程其实是差不多的。我们来看一个例子，用数学的方法解下列方程组：</p>

<p>\(\begin{cases}\ 2x + y + z = 1 (1)\ 6x + 2y + z = -1 (2)\ \ -2x + 2y + z = 7 (3)\  \end{cases}\)</p>

<ol>
<li>消去 \(x\):</li>
</ol>

<p>\((1) \times (-3) + (2)\) 得到 \(0x - y - 2z = -4\);</p>

<p>\((1) + (3)\) 得到 \(0x + 3y + 2z = 8\)，有：</p>

<p>\(\begin{cases}\ 2x + y + z = 1\ 0x - y - 2z = -4\ 0x + 3y + 2z = 8\end{cases}\)</p>

<ol>
<li>消去 \(y\):</li>
</ol>

<p>\((2) \times 3 + (3)\) 得到 \(0x + 0y - 4z = -4\)，有：</p>

<p>\(\begin{cases}\ 2x + y + z = 1\ 0x - y - 2z = -4\ 0x + 0y - 4z = -4\end{cases}\)</p>

<ol>
<li><p>从而我们得到 \(z = 1\)，将 \(z = 1\) 回带到 (2) 得到 \(y = 2\).</p></li>

<li><p>再把 \(z = 1, y = 2\) 回带到 (1) 得到 \(x = -1\).</p></li>
</ol>

<p>在我们具体的求解中，我们是把方程组的系数和值存储在数组中的：</p>

<table>
<thead>
<tr>
<th>index</th>
<th>x (0)</th>
<th>y (1)</th>
<th>z (2)</th>
<th>val (3)</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>

<tr>
<td>1</td>
<td>6</td>
<td>2</td>
<td>1</td>
<td>-1</td>
</tr>

<tr>
<td>2</td>
<td>-2</td>
<td>2</td>
<td>1</td>
<td>7</td>
</tr>
</tbody>
</table>

<p>因此，我们希望这个方程组最终变为如下的矩阵：</p>

<table>
<thead>
<tr>
<th>index</th>
<th>x (0)</th>
<th>y (1)</th>
<th>z (2)</th>
<th>val (3)</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>x</td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>y</td>
</tr>

<tr>
<td>2</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>z</td>
</tr>
</tbody>
</table>

<p>使用高斯消元法, 是以列为单位消元的。最终，第 i 行的 val 表示的就是第 i 个未知数的解。所以第一步我们需要枚举每一个式子 (i, 竖直行方向);</p>

<p>为了减少浮点误差，我们规定第 i 个式子往下的式子中，第 i 个未知数中系数最大的一个式子应当排在当前被减的这一行,假设其在第 k 行，那么我们就需要把 a[i][*] 与 a[k][*] 交换。以 i + 1 为起点枚举找到符合条件的 k，交换即可。例如当 i = 0 时执行上述交换，得到的新矩阵为：</p>

<table>
<thead>
<tr>
<th></th>
<th>x (0)</th>
<th>y (1)</th>
<th>z (2)</th>
<th>val (3)</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>6</td>
<td>2</td>
<td>1</td>
<td>-1</td>
</tr>

<tr>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>

<tr>
<td>2</td>
<td>-2</td>
<td>2</td>
<td>1</td>
<td>7</td>
</tr>
</tbody>
</table>

<p>然后将正在处理的方程式化简，让正被处理的系数化 1:</p>

<table>
<thead>
<tr>
<th></th>
<th>x (0)</th>
<th>y (1)</th>
<th>z (2)</th>
<th>val (3)</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>1</td>
<td><sup>1</sup>&frasl;<sub>3</sub></td>
<td><sup>1</sup>&frasl;<sub>6</sub></td>
<td>-<sup>1</sup>&frasl;<sub>6</sub></td>
</tr>

<tr>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>

<tr>
<td>2</td>
<td>-2</td>
<td>2</td>
<td>1</td>
<td>7</td>
</tr>
</tbody>
</table>

<p>再使用加减法，将剩下式子的第一个系数化 0。如化简 1 式时，因为 x 的系数为 2，那么就让 \(a[1][k] -= a[0][k] * 2\); 化简 3 式时，因为 x 的系数为 -2，那么就让 \(a[2][k] -= a[0][k] * (-2)\)，结果如下：</p>

<table>
<thead>
<tr>
<th></th>
<th>x (0)</th>
<th>y (1)</th>
<th>z (2)</th>
<th>val (3)</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>1</td>
<td><sup>1</sup>&frasl;<sub>3</sub></td>
<td><sup>1</sup>&frasl;<sub>6</sub></td>
<td>-<sup>1</sup>&frasl;<sub>6</sub></td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td><sup>1</sup>&frasl;<sub>3</sub></td>
<td><sup>2</sup>&frasl;<sub>3</sub></td>
<td><sup>4</sup>&frasl;<sub>3</sub></td>
</tr>

<tr>
<td>2</td>
<td>0</td>
<td><sup>8</sup>&frasl;<sub>3</sub></td>
<td><sup>4</sup>&frasl;<sub>3</sub></td>
<td><sup>20</sup>&frasl;<sub>3</sub></td>
</tr>
</tbody>
</table>

<p>同理，用这样的方法继续处理第 1,2 行，最后即可得到结果。例如处理第 1 行，把 \(y\) 项系数最大的式子提前：</p>

<table>
<thead>
<tr>
<th></th>
<th>x (0)</th>
<th>y (1)</th>
<th>z (2)</th>
<th>val (3)</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>1</td>
<td><sup>1</sup>&frasl;<sub>3</sub></td>
<td><sup>1</sup>&frasl;<sub>6</sub></td>
<td>-<sup>1</sup>&frasl;<sub>6</sub></td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td><sup>8</sup>&frasl;<sub>3</sub></td>
<td><sup>4</sup>&frasl;<sub>3</sub></td>
<td><sup>20</sup>&frasl;<sub>3</sub></td>
</tr>

<tr>
<td>2</td>
<td>0</td>
<td><sup>1</sup>&frasl;<sub>3</sub></td>
<td><sup>2</sup>&frasl;<sub>3</sub></td>
<td><sup>4</sup>&frasl;<sub>3</sub></td>
</tr>
</tbody>
</table>

<p>让第二个未知数 \(y\) 的系数为 1：</p>

<table>
<thead>
<tr>
<th></th>
<th>x (0)</th>
<th>y (1)</th>
<th>z (2)</th>
<th>val (3)</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>1</td>
<td><sup>1</sup>&frasl;<sub>3</sub></td>
<td><sup>1</sup>&frasl;<sub>6</sub></td>
<td>-<sup>1</sup>&frasl;<sub>6</sub></td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td>1</td>
<td><sup>1</sup>&frasl;<sub>2</sub></td>
<td><sup>5</sup>&frasl;<sub>2</sub></td>
</tr>

<tr>
<td>2</td>
<td>0</td>
<td><sup>1</sup>&frasl;<sub>3</sub></td>
<td><sup>2</sup>&frasl;<sub>3</sub></td>
<td><sup>4</sup>&frasl;<sub>3</sub></td>
</tr>
</tbody>
</table>

<p>然后使用加减法将剩余的式子化零：</p>

<table>
<thead>
<tr>
<th></th>
<th>x (0)</th>
<th>y (1)</th>
<th>z (2)</th>
<th>val (3)</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>-1</td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td>1</td>
<td><sup>1</sup>&frasl;<sub>2</sub></td>
<td><sup>5</sup>&frasl;<sub>2</sub></td>
</tr>

<tr>
<td>2</td>
<td>0</td>
<td>0</td>
<td><sup>1</sup>&frasl;<sub>2</sub></td>
<td><sup>1</sup>&frasl;<sub>2</sub></td>
</tr>
</tbody>
</table>

<p>最后按照上面的步骤处理第 2 行的式子。最终我们得到的矩阵如下：</p>

<table>
<thead>
<tr>
<th></th>
<th>x (0)</th>
<th>y (1)</th>
<th>z (2)</th>
<th>val (3)</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>-1</td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>2</td>
</tr>

<tr>
<td>2</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>要注意一下，高斯消元存在无解/多解的情况：如果有一个未知数在所有式子中，它的系数都是 0，那么该未知数是无法求解的，那么方程组也就不存在唯一解了。</p>

<p><a href="https://www.luogu.org/problemnew/show/P3389">luogu P3389 模板：高斯消元法</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;cstdio&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;cmath&gt; </span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;algorithm&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> MAXN <span style="color:#f92672">=</span> <span style="color:#ae81ff">205</span>;
<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">double</span> eps <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e-8</span>;        <span style="color:#75715e">// 浮点误差
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> n;
<span style="color:#66d9ef">double</span> del;
<span style="color:#66d9ef">double</span> a[MAXN][MAXN];

<span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">gauss</span>() {
    <span style="color:#75715e">// 对每个式子进行枚举 
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
        <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> i;
        <span style="color:#75715e">// 从 i 的下一个等式开始枚举 
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
            <span style="color:#75715e">// 比较第 k 个式子和第 j 个式子中未知数 i 系数的大小, fabs() 表示对浮点数取绝对值 
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> (fabs(a[j][i]) <span style="color:#f92672">&gt;</span> fabs(a[k][i])) {
                k <span style="color:#f92672">=</span> j;      <span style="color:#75715e">// 找到第 i 个未知数系数最大的 
</span><span style="color:#75715e"></span>            }
        }
        
        del <span style="color:#f92672">=</span> a[k][i];
        
        <span style="color:#75715e">// 如果有一个未知数在所有式子中的系数都为 0（绝对值最大值小于浮点误差），则无解 
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (fabs(del) <span style="color:#f92672">&lt;</span> eps) {
            <span style="color:#66d9ef">return</span> false;
        }
        
        <span style="color:#75715e">// 对于当前式子，与第 k 个式子交换所有项的系数，即当前式子实为未知数 i 系数最大的第 k 个式子 
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> i; j <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
            std<span style="color:#f92672">:</span><span style="color:#f92672">:</span>swap(a[i][j], a[k][j]);
        }
        
        <span style="color:#75715e">// 然后对当前式子的所有项（包括值）消去第 k 个式子中第 i 个未知数的系数 
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> i; j <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
            a[i][j] <span style="color:#f92672">/</span><span style="color:#f92672">=</span> del;
        }
        
        <span style="color:#75715e">// 处理其它的式子，对各项加上/减去相同系数 
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (k <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; k <span style="color:#f92672">&lt;</span> n; k<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
            <span style="color:#75715e">// 只对非当前式子操作 
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> (k <span style="color:#f92672">!</span><span style="color:#f92672">=</span> i) {
                del <span style="color:#f92672">=</span> a[k][i];
                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> i; j <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
                    a[k][j] <span style="color:#f92672">-</span><span style="color:#f92672">=</span> a[i][j] <span style="color:#f92672">*</span> del;
                }
            }
        }
    }
    <span style="color:#66d9ef">return</span> true;
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#75715e">// 未知数的数目 
</span><span style="color:#75715e"></span>    scanf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span>, <span style="color:#f92672">&amp;</span>n);
    
    <span style="color:#75715e">// n 个未知数，至少需要有 n 个等式才能求解，否则无解 
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) { 
        <span style="color:#75715e">// 注意第二个循环体的条件是 j &lt;= n，不要忘记了除了系数外还要输入一个多项式的值 
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
            scanf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%lf</span><span style="color:#e6db74">&#34;</span>, <span style="color:#f92672">&amp;</span>a[i][j]);
        }
    }
    <span style="color:#75715e">// a[i][j] 表示在第 i 个等式中第 j 个未知数的系数 
</span><span style="color:#75715e"></span>    
    <span style="color:#75715e">// 高斯消元求解，如果该方程组有解，返回 true 
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">bool</span> flag <span style="color:#f92672">=</span> gauss(); 
    
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>flag) {
        <span style="color:#75715e">// 无解
</span><span style="color:#75715e"></span>        printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">No Solution</span><span style="color:#e6db74">&#34;</span>);
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
            <span style="color:#75715e">// 输出第 i 个式子的值，即为第 i 个未知数的答案
</span><span style="color:#75715e"></span>            printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%.2lf</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, a[i][n]);
        }
    }
    
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div>
                    <HR width="100%" id="EOF">
                    <p style="color:#777;">Last modified on 2018-07-27</p>
                </div>
                
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://kirainmoe.com/blog/post/golang-note/">
                    Next<br>Golang 学习笔记 （1）
                </a>
                
                
                
                <a class="older-posts" href="https://kirainmoe.com/blog/post/redux-with-typescript-connect-component-problem/">
                    Previous<br>Typescript 下 Redux connect 带有 Props 组件的问题
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                
<div class="post-comment-wrapper">
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yume-diary" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>




            </div>
        </div>
    </div>
</div>

            </div><div id="single-column-footer">&copy;
	
	2016-2020 宇宙よりも遠い場所
	

/

<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC-BY-SA 4.0</a>

<br>

Published with <a href="https://gohugo.io">Hugo</a> / Theme <a href="https://github.com/amazingrise/hugo-theme-diary" title="Author: Rise @ amazingrise.net">Diary</a>
</div>
    	</div>
    <script src="https://kirainmoe.com//js/journal.js"></script>
    </body>
</html>
