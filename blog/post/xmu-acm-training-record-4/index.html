<body class="line-numbers">
  <!DOCTYPE html>
<html lang="en-us">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta content="" name="keywords">
<meta content="[19-3-23] XMU ACM 集训队笔记(4) 基础数论 - 宇宙よりも遠い場所" property="og:title">
<title>[19-3-23] XMU ACM 集训队笔记(4) 基础数论 | 宇宙よりも遠い場所</title>
<script src="https://unpkg.com/muse-player/dist/assets/muse-player.js"></script>
<link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
<link rel="stylesheet" href="https://kirainmoe.com//css/style.css">
<link rel="stylesheet" href="https://kirainmoe.com//css/custom.css">
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" integrity="sha384-9tPv11A+glH/on/wEu99NVwDPwkMQESOocs/ZGXPoIiLE8MU/qkqUcZ3zzL+6DuH" crossorigin="anonymous">
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none", 
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [["$", "$"], ["\\(", "\\)"]],
          displayMath: [["$$", "$$"], ["\\[", "\\]"]],
          skipTags: ["script", "noscript", "style", "textarea", "pre", "code", "a"]
        },
        "HTML-CSS": {
          availableFonts: ["STIX", "TeX"], 
          showMathMenu: false
        }
	  });
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism-solarizedlight.min.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/line-numbers/prism-line-numbers.min.css">

<style type="text/css">
	.nav-left {	display: block; text-align: left; }
	.nav-link { display: inline-block; margin: 0px 20px 0px 0px;  }
	.nav-item { justify-content: flex-start;  }
	.nav-title { margin: 0px; font-size: 28px; font-weight: bold;  }
	.nav-title a { padding: 10px 0px;  }
	@media screen and (max-width: 700px) {
		.nav { display: block; text-align: center;  }
		.nav-title > .nav-item { display: block;  text-align: center; }
		.nav-left { text-align: center;  }
	}
</style>

  <section class="section navigator">
  <div class="navigator-background"></div>
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <h1 class="nav-title"><a class="nav-item" href="https://kirainmoe.com/">宇宙よりも遠い場所</a></h1>
        <div class="nav-links">
          <a class="nav-link" href="/pages/guestbook/">Guestbook</a>
          <a class="nav-link" href="/pages/friends/">Friends</a>        
          <a class="nav-link" href="https://about.me/kirainmoe">About</a>
        </div>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile">
          
          <a class="level-item" href="https://github.com/kirainmoe">
            <span class="icon">
              <i class="fa fa-github"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://weibo.com/returnnnn">
            <span class="icon">
              <i class="fa fa-weibo"></i>
            </span>
          </a>
          
          <a class="level-item" href="/index.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>
          </a>
          
        </nav>
      </div>
    </nav>
  </div>
</section>

<div class="return-top">
  <i class="fa fa-angle-up"></i>
</div>

<div class="loading-progress"></div>
  <section class="section content-container">
    <div class="container article-here">
      <h2 class="subtitle is-6">April 25, 2019</h2>
      <h1 class="title">[19-3-23] XMU ACM 集训队笔记(4) 基础数论</h1>
      
      <div class="tags">
    
        <a class="button is-link" href="/tags/acm">acm</a>
    
        <a class="button is-link" href="/tags/algorithm">algorithm</a>
    
        <a class="button is-link" href="/tags/mathematics">mathematics</a>
    
</div>

      
      <div class="content">
        <p>本期主要内容：整除性、模运算性质、唯一分解定理、拓展欧几里得算法、乘法逆元、威尔逊定理、费马小定理、二次剩余。</p>

<p>因为这只是我自己的笔记，因此我会补充一些必要的证明过程，但考虑到效率问题，不会把所有的概念都讲成白话。</p>

<p>emmm……这篇文章似乎鸽了很久。</p>

<h1 id="整除性质">整除性质</h1>

<blockquote>
<p>定义：若 $a \div b = m &hellip; k$, 则 $a/b = m$ ($m$ 是 $a, b$ 的商)、$a \mod b = k$, $k$ 是余数。<br />
定理：对于 $\forall a, b \in N^{*}$, $a$ 可以被唯一表示成 $m \times b + k$ 的形式，其中 $0 \leq k &lt; b$.</p>
</blockquote>

<p>根据上述有关乘除的定理，我们可以推导出以下性质（下面默认 $a, b \in N^*$）：</p>

<ul>
<li>若 $a \times b \leq c$, 则 $a \leq \lfloor{\frac{c}{b}}\rfloor$</li>
</ul>

<blockquote>
<p>证明：将 $c$ 表示为 $c = mb + p (p \lt b)$<br />
则由 $a \leq \frac{c}{b}$ 得到 $a \leq m + \frac{p}{b}$<br />
又 $\lfloor \frac{c}{b} \rfloor = m$，$a \in N^*$ 且 $\frac{p}{b} \in [0, 1)$<br />
所以 $a \leq m$，从而 $a \leq \lfloor \frac{c}{b}\rfloor$，证毕。</p>
</blockquote>

<p>上述定理的必要性也成立:</p>

<ul>
<li>若 $a \leq \lfloor \frac{c}{b} \rfloor, 则 a \times b \leq c$.</li>
</ul>

<blockquote>
<p>证明: 将 $c$ 表示为 $mb + p(p &lt; b)$，则 $a \leq m$<br />
那么 $a \times b \leq m \times b \leq m \times b + p = c$, 证毕。</p>
</blockquote>

<ul>
<li>若 $a \times b \geq c$, 则 $a \geq \lfloor\frac{c}{b}\rfloor$.</li>
</ul>

<blockquote>
<p>证明：将 $c$ 表示为 $mb + p(p &lt; b)$，则 $a \times b \geq mb + p$<br />
即 $a \geq m + \frac{p}{b}$<br />
显然 $\lfloor \frac{c}{b} \rfloor = m \leq m + \frac{p}{b}.$</p>
</blockquote>

<p>但上述定理的必要性：若 $a \geq \lfloor \frac{c}{b} \rfloor$，则 $a \times b \geq c$ 是不成立的。</p>

<blockquote>
<p>证明：假设上述定理成立，将 $c$ 表示为 $mb + p$<br />
则 $a \geq m$，当 $p \geq 0$ 时，<br />
由 $a \times b \geq mb$，$mb \lt mb + p = c$.<br />
故上式不成立。</p>
</blockquote>

<ul>
<li>$a / b / c = a / (b * c) = a / c / b$, 其中 $/$ 是整除符号。</li>
</ul>

<blockquote>
<p>证明：设 $a = k(b \times c) +t$, 则:<br />
$a/b/c = kc/c = k$<br />
$a / (b * c) = k$<br />
$a/c/b = kb/b = k$<br />
证毕。</p>
</blockquote>

<h1 id="模运算性质">模运算性质</h1>

<p>模运算的性质可以说是很基础的东西了：</p>

<ul>
<li>$(a + b) \mod n = (a \mod n + b \mod n) \mod n$</li>
<li>$(a - b) \mod n = (a \mod n - b \mod n) \mod n$</li>
</ul>

<p>注意，因为在 C++ 中的取模运算规则是向零取模，所以上面的式子在 C++ 中应用时应该被变形为：
$(a - b) \mod n = (a \mod n - b \mod n + n) \mod n$.</p>

<ul>
<li>$(a \times b) \mod n = [(a \mod n) \times (b \mod n)] \mod n$</li>
</ul>

<p>上述定律不可推广到除法。但有如下推论：</p>

<ul>
<li>$[(a \times n) \mod (b \times n)] = (a \mod b) \times n$.</li>
</ul>

<h1 id="最大公因数">最大公因数</h1>

<p>设有正整数 $a, b (a \ge b)$, 定义 $gcd(a, b)$ 为 $a, b$ 的最大公约数 (greatest common divisor). 我们约定 $gcd(n, 0) = n$.</p>

<p>求两个数最大公因数的方式一般有两种：</p>

<p><strong>更相减损术</strong>：$gcd(a, b) = gcd(b, a-b) = &hellip;$, 这种方法用于求两个高精度数的最大公约数很有效（因为高精度的除法不易实现）。但如果遇到一个数很大，另一个数比较小的情况，该算法的复杂度可能会退化到 $O(n)$.</p>

<pre><code class="language-cpp">int gcd(int a, int b) {
    if (b == 0)
        return a;
    if (a &lt; b)
        std::swap(a, b);
    return gcd(b, a - b);
}
</code></pre>

<p><strong>欧几里得算法（辗转相除法）</strong>：$gcd(a, b) = gcd(b, b \mod a)$，该算法的复杂度是稳定为 $O(logn)$ 的，所以平时求 GCD 较多采用这种方法。</p>

<pre><code class="language-cpp">int gcd(int a, int b) {
    return b == 0 ? a : gcd(b, a % b);
}
</code></pre>

<h2 id="拓展欧几里得算法-exgcd">拓展欧几里得算法 (exgcd)</h2>

<p>再把旧的东西复习一遍吧。对于不全为零的非负整数 $a, b$ 和等式 $ax + by = gcd(a, b)$，我们可以用拓展欧几里得算法（exgcd）来求 $x, y$ 的一组可行解。</p>

<p>原理很简单：因为 $gcd(a, b) = gcd(b, a \mod b)$，所以有方程组</p>

<p>$$\begin{cases} ax_1 + by_1 = gcd(a, b) = m \\ bx_2 + (a \mod b)y_2 = gcd(b, a \mod b) = m\end{cases}$$.</p>

<p>而对于上述方程组整理得到等式</p>

<p>$$ ax_1 + by_1 = bx_2 + (a \mod b)y_2 $$.</p>

<p>根据上文对整除和余数的定义，因为 $a \mod b = a - \lfloor\frac{a}{b}\rfloor\cdot b$，所以上面的式子化为：</p>

<p>$$ ax_1 + by_1 = bx_2 + (a - [a \div b] \cdot b)y_2 $$</p>

<p>即</p>

<p>$$ax_1 + by_1 = ay_2 + b(x_2 - [a \div b] y_2)$$</p>

<p>根据方程对应系数的关系，得到方程组 (*)：</p>

<p>$$\begin{cases} x_1 = y_2 \\ y_1 = (x_2 - [a \div b] y_2) \end{cases}$$</p>

<p>我们要求的是 $x, y$ 的一组解，也就是说所求是 $x_1, y_1$. 那么，我们只要知道了 $x_2, y_2$ 即可推出 $x_1, y_1$. 根据上面的规则，我们可以得到递推方程组：</p>

<p>$$\begin{cases} bx_2 + (a \mod b)y_2 = gcd(b, a \mod b) = m \\(a \mod b) x_3 + (b \mod (a \mod b))y_3 = gcd(a \mod b, b \mod (a \mod b)) = m \end{cases}$$</p>

<p>因为最终上述递推方程 $a&rsquo;x+b&rsquo;y = gcd(a&rsquo;, b&rsquo;)$ 中，$b&rsquo; = 0$，此时 $gcd(a&rsquo;, b&rsquo;) = a&rsquo;$，显然有$x=1, y=*$ 是方程的一组解，我们这里取 $x = 1, y = 0$. 层层回溯即可得到 $x_1, y_1$.</p>

<p>exgcd 算法的关键在于理解并记住递推关系方程组 (*)，理解之后主程序就好写了。</p>

<pre><code class="language-cpp">int x, y;
void exgcd(int a, int b, int &amp;x, int &amp;y) {
    if (b == 0) {
        x = 1, y = 0;
        return;
    }
    exgcd(b, a % b);
    int tmp = x;
    x = y;
    y = tmp - (a / b) * y;
}
</code></pre>

<p>exgcd 可以用于：(1) 求解二元一次方程 $ax + by = c$. 设 $gcd(a, b) = d$，那么上述方程有解的充要条件是 $d$ 是 $c$ 的约数，即 $c = nd$. 使用 exgcd 求出一组可行解 $x_1, y_1$ 后将其乘以系数 $\frac{c}{d}$ 即可，即原方程的一组解为：</p>

<p>$$\begin{cases}x = x_1 \cdot \frac{c}{d} \\ y = y_1 \cdot \frac{c}{d} \end{cases}$$</p>

<p>(2) 求解乘法逆元。</p>

<h1 id="乘法逆元">乘法逆元</h1>

<p>首先引入同余这一概念，顾名思义——同余就是相同余数的意思。</p>

<blockquote>
<p>同余：对于两个整数 $a, b$ 和正整数 $k$, 如果 $a \mod k = n$, $b \mod k = n$，也就是说 $a, b$ 除 $k$ 的整数相同都是 $n$, 此时我们称 $a, b$ 在模 $k$ 的意义下同余，记作 $a \equiv b (\mod k)$.</p>
</blockquote>

<p>接下来引入乘法逆元的概念：</p>

<blockquote>
<p>乘法逆元：如果 $ax$ 与 $1$ 在模 $p$ 的意义下同余，也就是说 $ax \mod p = 1 \mod p, ax \equiv 1(\mod p)$, 并且 $a, p$ 互为质数（即 $gcd(a, p) = 1$），那么我们定义：<strong>$x$ 是 $a$ 关于模 $p$ 的乘法逆元</strong>。$x$ 在模 $p$ 的意义下是唯一的，即 $0 \leq x \leq p-1$ 时，逆元 $x$ 是惟一的。</p>
</blockquote>

<p>怎么理解？在实数意义下，非零实数 $a$ 与非零实数 $\frac{1}{a}$ 相乘的结果为 1；但是在模某一个数 $p$ 意义下，满足 $ax \mod p = 1 \mod p$ 的数 $x$ 并不一定是 $\frac{1}{a}$，而可能是一个其它整数，这个整数就称为乘法逆元。</p>

<p>求逆元的方法之一：使用 exgcd 来求乘法逆元。为什么可以用 exgcd 求逆元呢？首先我们来看看我们要求的逆元是什么：对于 $kx \equiv 1 (\mod p), gcd(k, p) = 1$，我们要求的是 $x$. 接下来我们再看看 exgcd 求的是什么：对于 $ax+by=gcd(a, b)$，我们求得是 $x, y$ 的一组解。</p>

<p>其中式1： $kx \equiv 1 (\mod p)$ 可以转化为 $kx - py = gcd(k, p) = 1$，第二项的符号可以合到 $y$ 中去，然后令 $a=k, b=p$，就等于求解 $ax&rsquo;+by&rsquo;=gcd(a,b)=1$ 了，此时就可以用 exgcd 来求了，我们想要的逆元 $x$ 其实就是执行 exgcd 后 $x$ 的值。但此时的 $x$ 是在实数范围内的，可能有多组解，为了让我们的逆元在模 $p$ 的意义内唯一，我们可以对 $x$ 做如下变换：$x=(x\mod p+p)\mod p$，这就是我们要求的逆元了。</p>

<pre><code class="language-cpp">int x, y;
void exgcd(int a, int b, int &amp;x, int &amp;y) {
    if (b == 0) {
        x = 1, y = 0;
        return;
    }
    exgcd(b, a % b, x, y);
    int tmp = x;
    x = y;
    y = tmp - (a / b) * y;
}
int inv(int k, int p) {
    exgcd(k, p, x, y);
    return ((x % p) + p) % p;
}
</code></pre>

<h2 id="费马小定理">费马小定理</h2>

<blockquote>
<p>定理：假如 $a$ 是一个整数 $(a \in N)$，$p$ 是一个质数，那么 $a^p - a$ 是 $p$ 的倍数，可以表示为 $a^p  - a\equiv 0 (\mod p)$，即 $a^p \equiv a (\mod p)$，从而 $a^{p-1} \equiv 1 (\mod p)$.</p>
</blockquote>

<p>根据费马小定理公式 $a^{p-1} \equiv 1 (\mod p)$，有 $a \cdot a^{p-2} \equiv 1 (\mod p)$. 这里 $a^{p-2}$ 就是我们想求的逆元。$a^{p-2}$ 显然可以用快速幂来快速求得：</p>

<pre><code class="language-cpp">long long mod_pow(long long a, long long mod) {
    long long ans = 1, b = a;
    while (b) {
        if (b &amp; 1)
            ans = ans * a % mod;
        a = a * a % mod;
        b &gt;&gt;= 1;
    }
    return ans;
}
long long inv(long long num, long long mod) {
    return mod_pow(num, mod - 2, mod);
}
</code></pre>

<h1 id="威尔逊定理">威尔逊定理</h1>

<p>威尔逊定理是初等数论中用于判断一个自然数是否为素数的充要条件：</p>

<blockquote>
<p>对于整数 $p$ ，当且仅当 $(p-1)! \equiv -1 (\mod p)$ 时，$p$ 为素数。</p>
</blockquote>

<p>证明略去，有兴趣的话参见 <a href="https://www.jianshu.com/p/ad5bb5b8fa7d">https://www.jianshu.com/p/ad5bb5b8fa7d</a></p>

<h1 id="唯一分解定理">唯一分解定理</h1>

<blockquote>
<p>唯一分解定理：一个大于 1 的正整数 $n$，能够被唯一分解为若干个质数幂次乘积的形式，即：$x=p_1^{a_1}\cdot p_2^{a_2} \cdot &hellip; \cdot p_n^{a_n}$，其中 $p_i$ 为质数。</p>
</blockquote>

<p>根据唯一分解定理我们可以得到一些有用的推论：</p>

<blockquote>
<p>一个整数 $n$ 的全体正因数之和为：$\Sigma(N)= (1+ p_1 + p_1 ^2 +&hellip; + p_1^{a_1}) (1+p_2 + p_2^2 +&hellip; + p_2^{a_2}) &hellip; (1+p_n + p_n^2 +&hellip; + p_n^{a_n})$</p>

<p>一个整数 $n$ 的正因子个数为：$f(n) = (1+a_1)(1+a_2)&hellip;(1+a_n)$</p>
</blockquote>

<p>相关例题日后开文补吧。</p>
      </div>
    </div>
  
<section class="section">
  <div class="container">
    <aside><div id="disqus_thread"></div></aside>
    <script type="text/javascript">
      var disqus_shortname = 'yume-diary';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</section>


  </section>
  <section class="section footblock">
  <img src="https://secure.gravatar.com/avatar/c47187d311099868de825697fa419654?s=200&r=G" width="70px" height="70px" class="avatar">
  <div class="container has-text-centered">
    <p>&copy;2016-2019&nbsp;&nbsp;<a href='https://kirainmoe.com'>宇宙よりも遠い場所</a>  / Published with <a href="https://gohugo.io">Hugo</a> / <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC-BY-SA 4.0</a> Licensed</p>
  </div>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js" integrity="sha256-HWJnMZHGx7U1jmNfxe4yaQedmpo/mtxWSIXvcJkLIf4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js" integrity="sha256-ht8ay6ZTPZfuixYB99I5oRpCLsCq7Do2LjEYLwbe+X8=" crossorigin="anonymous"></script>


<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-go.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-javascript.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-matlab.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-c.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-cpp.min.js"></script>


<canvas id="live2d" width="300" height="300"></canvas>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/line-numbers/prism-line-numbers.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script>
<script src="https://kirainmoe.com//index.js"></script>
<script type="text/javascript" src="https://kirainmoe.com//js/live2d.js"></script>
<script type="text/javascript">
  if (!window.mobilecheck())
  loadlive2d("live2d", "https:\/\/kirainmoe.com\//model/aya/model.json");
</script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-111347233-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</body>
