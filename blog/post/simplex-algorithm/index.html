<!DOCTYPE html>
<html><head>
<title>【学习笔记】线性规划的单纯形算法</title>

<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">




<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-111347233-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



<script src="/vendor/js/jquery.min.js" ></script>
<script src="/vendor/js/popper.min.js" ></script>
<script src="/vendor/js/bootstrap.min.js" ></script>
<script src="/vendor/js/smooth-scroll.polyfills.min.js" ></script>
<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">
<script src="/vendor/js/vue.min.js" ></script>




<link rel="stylesheet" href="https://kirainmoe.com/scss/journal.min.d1b323a5bdb0e7b05730834eb664c761432cfb57d618b4efeb5a9417a66a4b44.css" integrity="sha256-0bMjpb2w57BXMINOtmTHYUMs&#43;1fWGLTv61qUF6ZqS0Q=" media="screen">

<script src="https://kirainmoe.com//js/loadCSS.js"></script>
<script src="https://kirainmoe.com//js/table.js"></script>


<script src="https://kirainmoe.com//js/toc.js"></script>


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      showProcessingMessages: false,
      messageStyle: "none", 
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [["$", "$"], ["\\(", "\\)"]],
        displayMath: [["$$", "$$"], ["\\[", "\\]"]],
        skipTags: ["script", "noscript", "style", "textarea", "pre", "code", "a"]
      },
      "HTML-CSS": {
        availableFonts: ["STIX", "TeX"], 
        showMathMenu: false
      }
  });
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script src="https://unpkg.com/muse-player/dist/assets/muse-player.js"></script>

<script>
    loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons");
</script>

</head><body>
    	<div id="app"><div ref="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://kirainmoe.com/">
    
        <div class="nav-title">
            宇宙よりも遠い場所
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
                
                
                <a class="a-block nav-link-item false" href="/pages/guestbook">
                    留言板
                </a>
        
            
                
                
                <a class="a-block nav-link-item false" href="/pages/friends">
                    友情链接
                </a>
        
            
                
                
                <a class="a-block nav-link-item false" href="/tags">
                    标签
                </a>
        
            
                
                
                <a class="a-block nav-link-item false" href="/pages/about">
                    关于
                </a>
        
    </div>

    

    <div class="nav-footer">
        &copy;
	
	2016-2020 宇宙よりも遠い場所
	

/

<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC-BY-SA 4.0</a>

<br>

Published with <a href="https://gohugo.io">Hugo</a> / Theme <a href="https://github.com/amazingrise/hugo-theme-diary" title="Author: Rise @ amazingrise.net">Diary</a>

    </div>

    
    <script src="https://tj.kirainmoe.com/cgi-bin/inject_script.cgi"></script>
    
</div><div ref="extraContainer" class="extra-container">
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8d%95%e7%ba%af%e5%bd%a2%e7%ae%97%e6%b3%95-%e5%b9%b2%e5%95%a5%e7%94%a8%e7%9a%84" v-on:click="closeDrawer" id="单纯形算法-干啥用的-nav">
										 单纯形算法？干啥用的？
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e7%ba%bf%e6%80%a7%e8%a7%84%e5%88%92" v-on:click="closeDrawer" id="线性规划-nav">
										 线性规划
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e7%ba%bf%e6%80%a7%e8%a7%84%e5%88%92%e4%b8%80%e8%88%ac%e5%bd%a2%e5%bc%8f" v-on:click="closeDrawer" id="线性规划一般形式-nav">
										 线性规划一般形式
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e7%ba%bf%e6%80%a7%e8%a7%84%e5%88%92%e6%a0%87%e5%87%86%e5%bd%a2%e5%bc%8f" v-on:click="closeDrawer" id="线性规划标准形式-nav">
										 线性规划标准形式
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%a6%82%e4%bd%95%e5%8c%96%e6%88%90%e6%a0%87%e5%87%86%e5%bd%a2%e5%bc%8f" v-on:click="closeDrawer" id="如何化成标准形式-nav">
										 如何化成标准形式？
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e6%a0%87%e5%87%86%e5%bd%a2%e5%bc%8f%e7%9a%84%e7%9f%a9%e9%98%b5%e8%a1%a8%e7%a4%ba" v-on:click="closeDrawer" id="标准形式的矩阵表示-nav">
										 标准形式的矩阵表示
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8d%95%e7%ba%af%e5%bd%a2%e6%b3%95" v-on:click="closeDrawer" id="单纯形法-nav">
										 单纯形法
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8e%9f%e7%90%86" v-on:click="closeDrawer" id="原理-nav">
										 原理
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%e7%9f%a5%e8%af%86" v-on:click="closeDrawer" id="线性代数知识-nav">
										 线性代数知识
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%85%b7%e4%bd%93%e6%ad%a5%e9%aa%a4" v-on:click="closeDrawer" id="具体步骤-nav">
										 具体步骤
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#step-1-%e6%89%be%e5%88%b0%e4%b8%80%e7%bb%84%e5%88%9d%e5%a7%8b%e7%9a%84%e5%8f%af%e8%a1%8c%e8%a7%a3-%e5%8f%af%e8%a1%8c%e5%9f%ba" v-on:click="closeDrawer" id="step-1-找到一组初始的可行解-可行基-nav">
										 STEP 1. 找到一组初始的可行解（可行基）
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#step-2-%e5%af%bb%e6%89%be%e6%9b%b4%e4%bc%98%e8%a7%a3" v-on:click="closeDrawer" id="step-2-寻找更优解-nav">
										 STEP 2. 寻找更优解
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#step-3-%e5%be%aa%e7%8e%af%e8%bf%ad%e4%bb%a3%e4%b8%8a%e8%bf%b0%e8%bf%87%e7%a8%8b-%e7%9b%b4%e5%88%b0%e6%89%be%e5%88%b0%e6%9c%80%e4%bc%98%e8%a7%a3" v-on:click="closeDrawer" id="step-3-循环迭代上述过程-直到找到最优解-nav">
										 STEP 3. 循环迭代上述过程，直到找到最优解
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e6%80%bb%e7%bb%93" v-on:click="closeDrawer" id="总结-nav">
										 总结
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e4%bb%a3%e7%a0%81" v-on:click="closeDrawer" id="代码-nav">
										 代码
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#ext-%e5%af%b9%e5%81%b6%e5%8e%9f%e7%90%86" v-on:click="closeDrawer" id="ext-对偶原理-nav">
										 Ext: 对偶原理
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae" v-on:click="closeDrawer" id="参考文献-nav">
										 参考文献
									</a>
								</li>
						
							</ul>
						
					
				
			
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
    </div>
</div><div class="single-column-drawer-container" ref="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
                
                    
                    
                    <a class="a-block drawer-menu-item false" href="/pages/guestbook">
                        留言板
                    </a>
            
                
                    
                    
                    <a class="a-block drawer-menu-item false" href="/pages/friends">
                        友情链接
                    </a>
            
                
                    
                    
                    <a class="a-block drawer-menu-item false" href="/tags">
                        标签
                    </a>
            
                
                    
                    
                    <a class="a-block drawer-menu-item false" href="/pages/about">
                        关于
                    </a>
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8d%95%e7%ba%af%e5%bd%a2%e7%ae%97%e6%b3%95-%e5%b9%b2%e5%95%a5%e7%94%a8%e7%9a%84" v-on:click="closeDrawer" id="单纯形算法-干啥用的-nav">
										 单纯形算法？干啥用的？
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e7%ba%bf%e6%80%a7%e8%a7%84%e5%88%92" v-on:click="closeDrawer" id="线性规划-nav">
										 线性规划
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e7%ba%bf%e6%80%a7%e8%a7%84%e5%88%92%e4%b8%80%e8%88%ac%e5%bd%a2%e5%bc%8f" v-on:click="closeDrawer" id="线性规划一般形式-nav">
										 线性规划一般形式
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e7%ba%bf%e6%80%a7%e8%a7%84%e5%88%92%e6%a0%87%e5%87%86%e5%bd%a2%e5%bc%8f" v-on:click="closeDrawer" id="线性规划标准形式-nav">
										 线性规划标准形式
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%a6%82%e4%bd%95%e5%8c%96%e6%88%90%e6%a0%87%e5%87%86%e5%bd%a2%e5%bc%8f" v-on:click="closeDrawer" id="如何化成标准形式-nav">
										 如何化成标准形式？
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e6%a0%87%e5%87%86%e5%bd%a2%e5%bc%8f%e7%9a%84%e7%9f%a9%e9%98%b5%e8%a1%a8%e7%a4%ba" v-on:click="closeDrawer" id="标准形式的矩阵表示-nav">
										 标准形式的矩阵表示
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8d%95%e7%ba%af%e5%bd%a2%e6%b3%95" v-on:click="closeDrawer" id="单纯形法-nav">
										 单纯形法
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8e%9f%e7%90%86" v-on:click="closeDrawer" id="原理-nav">
										 原理
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%e7%9f%a5%e8%af%86" v-on:click="closeDrawer" id="线性代数知识-nav">
										 线性代数知识
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%85%b7%e4%bd%93%e6%ad%a5%e9%aa%a4" v-on:click="closeDrawer" id="具体步骤-nav">
										 具体步骤
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#step-1-%e6%89%be%e5%88%b0%e4%b8%80%e7%bb%84%e5%88%9d%e5%a7%8b%e7%9a%84%e5%8f%af%e8%a1%8c%e8%a7%a3-%e5%8f%af%e8%a1%8c%e5%9f%ba" v-on:click="closeDrawer" id="step-1-找到一组初始的可行解-可行基-nav">
										 STEP 1. 找到一组初始的可行解（可行基）
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#step-2-%e5%af%bb%e6%89%be%e6%9b%b4%e4%bc%98%e8%a7%a3" v-on:click="closeDrawer" id="step-2-寻找更优解-nav">
										 STEP 2. 寻找更优解
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#step-3-%e5%be%aa%e7%8e%af%e8%bf%ad%e4%bb%a3%e4%b8%8a%e8%bf%b0%e8%bf%87%e7%a8%8b-%e7%9b%b4%e5%88%b0%e6%89%be%e5%88%b0%e6%9c%80%e4%bc%98%e8%a7%a3" v-on:click="closeDrawer" id="step-3-循环迭代上述过程-直到找到最优解-nav">
										 STEP 3. 循环迭代上述过程，直到找到最优解
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e6%80%bb%e7%bb%93" v-on:click="closeDrawer" id="总结-nav">
										 总结
									</a>
								</li>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e4%bb%a3%e7%a0%81" v-on:click="closeDrawer" id="代码-nav">
										 代码
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#ext-%e5%af%b9%e5%81%b6%e5%8e%9f%e7%90%86" v-on:click="closeDrawer" id="ext-对偶原理-nav">
										 Ext: 对偶原理
									</a>
								</li>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae" v-on:click="closeDrawer" id="参考文献-nav">
										 参考文献
									</a>
								</li>
						
							</ul>
						
					
				
			
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav ref="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div ref="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a ref="navTitle" class="navbar-brand" href="https://kirainmoe.com/">
            宇宙よりも遠い場所
        </a>
    </div>
</nav>
<div class="single-column-header-container" ref="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://kirainmoe.com/">
        <div class="single-column-header-title">宇宙よりも遠い場所</div>
        

    </a>
</div>
            <div id="content">
<div ref="streamContainer" class="stream-container">
    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                 style="background-image: url('/')">
                <div class="post-title">
                    【学习笔记】线性规划的单纯形算法
                    <div class="post-meta">
                        <time itemprop="datePublished">
                            2020-02-11 18:35
                        </time>

                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/acm">acm</a>
                                &nbsp;
                            
                                <a href="/tags/algorithm">algorithm</a>
                                &nbsp;
                            
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                <div class="post-body">
                    <h1 id="单纯形算法-干啥用的">单纯形算法？干啥用的？</h1>

<p>它可以用于求解多维线性规划问题。</p>

<p>在开始之前，我们先约定一些记号：</p>

<ul>
<li>$\max z$ 或 $\min z$，表示求函数 $z$ 的最大值或最小值。</li>
<li>$s.t.$ (subject to)，表示满足某些条件，受到某些约束。</li>
</ul>

<h1 id="线性规划">线性规划</h1>

<p>回忆一下高中数学里二元线性规划的题目：设变量 $x, y$ 满足几个不等式的约束条件，求 $z = ax + by$ 的最大值或最小值。一个解决此类问题比较常用的方法是<strong>图解法</strong>，也就是在平面直角坐标系中，画出不等式约束条件所代表的<strong>可行域</strong>，然后将 $z = ax + by$ 化为直线形式 $y = -\frac{a}{b}x + \frac{z}{b}$ ，在可行域内移动这条直线，使得截距 $\frac{z}{b}$ 取得最大值或最小值，从而最大化或最小化 $z$ 的取值。</p>

<p><img src="https://oi-wiki.org/math/images/kexingyu.jpg" alt="lp problem" /></p>

<p>对于比较复杂的多元线性规划问题，图解法显然很难解决。此时我们可以使用单纯形算法来解决。</p>

<h2 id="线性规划一般形式">线性规划一般形式</h2>

<p>对于线性规划问题，常以如下的一般形式给出：</p>

<ul>
<li><strong>目标函数</strong> $\min z$ 或 $\max z$，其中 $z$ 等于 $m$ 个决策变量的加权和</li>
<li>$m$ 个决策变量满足 $n$ 个<strong>方程约束或不等式约束</strong></li>
<li><strong>决策变量非负</strong></li>
</ul>

<p>$$\max z = c_1x_1 + c_2x_2 + &hellip; + c_mx_m$$
$$s.t. \begin{cases} a_{11}x_1 + a_{12}x_2 + &hellip; + a_{1m}x_m \le b_1 \\ a_{21}x_1 + a_{2 2}x_2 + &hellip; + a_{2m}x_m \le b_2 \\ &hellip; \\ a_{n1}x_1 + a_{n2}x_2 + &hellip; + a_{nm}x_m = b_n \\ x_1, x_2, &hellip;, x_m \ge 0 \end{cases}$$</p>

<p>将上面的模型简化：</p>

<p>$$\max z = \sum_{j=1}^{m} c_jx_j$$
$$s.t. \begin{cases}\sum_{i=1}^{m}a_{ij}x_j \le b_i (i \in 1, 2, &hellip;, n) \\ x_1, x_2, &hellip;, x_n \ge 0 \end{cases}$$</p>

<h2 id="线性规划标准形式">线性规划标准形式</h2>

<p>为了使用单纯形算法来求解线性规划问题，需要先将线性规划模型化为<strong>标准形式</strong>。规定线性规划的标准形式满足：</p>

<ul>
<li>目标函数为<strong>最大值</strong>：$\max z$</li>
<li>所有约束都为<strong>等式约束（方程约束）</strong></li>
<li><strong>决策变量非负</strong></li>
</ul>

<p>即：</p>

<p>$$\max z = \sum_{j=1}^{m} c_jx_j$$
$$s.t. \begin{cases}\sum_{i=1}^{m}a_{ij}x_j = b_i (i \in 1, 2, &hellip;, n) \\ x_1, x_2, &hellip;, x_n \ge 0 \end{cases}$$</p>

<p>可以证明：任意线性规划的一般形式，都可以通过对目标函数取负、添加<strong>松弛变量</strong>等操作，化成标准形式。</p>

<h3 id="如何化成标准形式">如何化成标准形式？</h3>

<ul>
<li>如果目标函数为最小值$\min z = \sum_{j=1}^{m} c_jx_j$，则可以通过对目标函数取负转化为求最大值；即将目标函数转化为：$\max -z = \sum_{j=1}^{m} c_j&rsquo;x_j$, 其中 $c_j&rsquo; = -c_j$；</li>
<li>如果约束中存在小于等于不等式约束 $\sum_{j=1}^{m} a_{ij}x_j \le b_i$，则可以在等式左侧加上松弛变量 $x_{m+i}$，将其转化为等式约束：$\sum_{j=1}^{m} a_{ij}x_j + x_{m+i} = b_i$；</li>
<li>如果约束中存在大于等于不等式约束，同理可以在等式左侧减去松弛变量，将其转化为等式约束。</li>
<li>如果约束中存在无约束变量 $-\infty &lt; x_j &lt; \infty$，则可以将其表示为两个非负变量的差，即 $x_j = x_j^{&lsquo;} - x_j^{&ldquo;}$.</li>
</ul>

<p>举个栗子，对于以下线性规划形式：</p>

<p>$$\min -z = -x_1 - x_2$$
$$s.t. \begin{cases} 2x_1 + x_2 \le 12 \\ x_1 + 2x_2 \le 9 \\ x_1, x_2 \ge 0 \end{cases}$$</p>

<p>将其化为标准型：</p>

<p>$$\max z = x_1 + x_2 (+ 0x_3 + 0x_4)$$
$$s.t. \begin{cases} 2x_1 + x_2 + x_3 = 12 \\ x_1 + 2x_2 + x_4 = 9 \\ x_1, x_2, x_3, x_4 \ge 0 \end{cases}$$</p>

<p>可以看到，我们添加了两个松弛变量 $x_3, x_4$，使不等式约束化为了等式约束。</p>

<h2 id="标准形式的矩阵表示">标准形式的矩阵表示</h2>

<p>我们可以将上述线性规划的标准型，化成线性代数中的矩阵相乘形式以便后续的理解，如：</p>

<p>$$\max z = c^T X$$
$$ s.t. \begin{cases} AX = B \\ X \ge 0 \end{cases} $$</p>

<p>其中：</p>

<ul>
<li>$c$ 是目标函数中决策变量的加权系数列向量</li>
<li>$X$ 是决策变量组成的列向量</li>
<li>$A$ 是等式约束中的系数矩阵</li>
<li>$B$ 则是等式右侧的常数矩阵</li>
</ul>

<h1 id="单纯形法">单纯形法</h1>

<h2 id="原理">原理</h2>

<p>首先，我们需要知道线性规划问题中的一个结论：<strong>线性规划问题的最优解，一定在可行域的顶点上。</strong></p>

<p>单纯形法的原理是这样的：</p>

<blockquote>
<p>单纯形法就是通过设置不同的<strong>基向量</strong>，经过矩阵的<strong>线性变换</strong>，求得<strong>基可行解</strong>（可行域顶点），并判断该解是否最优，否则继续设置另一组基向量，重复执行以上步骤，直到找到<strong>最优解</strong>。所以，单纯形法的求解过程是一个循环迭代的过程。</p>
</blockquote>

<h2 id="线性代数知识">线性代数知识</h2>

<p><strong>线性无关</strong>：矢量空间中的一组向量 $\mathbf{a_1, a_2, &hellip;, a_n}$，如果任意一个向量 $\mathbf{a_i}$ 都<strong>不能</strong>被其它向量的线性组合表示，即 $\mathbf{a_i}$ 无法被表示为 $c_1\mathbf{a_1} + &hellip; c_{i-1}\mathbf{a_{i-1}} + c_{i+1}\mathbf{a_{i+1}} + &hellip; + c_{n}\mathbf{a_{n}}$ （$c_j$ 为常数，可取任意值），则称这组向量  $\mathbf{a_1, a_2, &hellip;, a_n}$ 线性无关。</p>

<p><strong>基</strong>：向量空间 $\mathbf{V}$，若有一组<strong>线性无关的</strong>向量  ${\mathbf{a_1, a_2, &hellip;, a_n}} \subset \mathbf{V}$，使得对于 $\forall \mathbf{x} \in V$，向量 $\mathbf{x}$ 都可以被 ${\mathbf{a_1, a_2, &hellip;, a_n}}$ 线性表示，则称这组线性无关的向量为向量空间 $\mathbf{V}$ 的一组基。<strong>同一个向量空间的基可以是不唯一的</strong>。</p>

<p><strong>基向量</strong>：向量空间基中的向量，即 $\mathbf{a_1, a_2&hellip;, a_n}$。</p>

<p><strong>变换</strong>：<br />
设在向量空间 $\mathbf{V}$ 中有两组基 $\mathbf{a_1, a_2, &hellip;, a_n}$ 及 $\mathbf{b_1, b_2, &hellip;, b_n}$，满足 $$\begin{cases} b_1 = p_{11}a_1 + p_{12}a_2 + &hellip; + p_{n1}a_n \\ b_2 = p_{21}a_1 + p_{22}a_2 + &hellip; + p_{n2}a_n \\ &hellip; \\ b_n = p_{n1}a_1 + p_{n2}a_2 + &hellip; + p_{nn}a_n \end{cases}$$
即：
$$(\mathbf{b_1, b_2, &hellip;, b_n}) = (\mathbf{a_1, a_2, &hellip;, a_n}) \cdot \mathbf{P}$$</p>

<p>这是一组<strong>基变换</strong>，也就是向量空间的一组基，可以通过乘上某一个变换矩阵，变成该向量空间的另一组基。</p>

<p>同理有<strong>坐标变换</strong>：设在向量空间有一向量 $\mathbf{x}$，以基 $\mathbf{a_1, a_2, &hellip;, a_n}$ 表示时的坐标为 $(x_1, x_2, .., x_n)^T$；以基 $\mathbf{b_1, b_2, &hellip;, b_n}$ 表示时的坐标为 $(x_1&rsquo;, x_2&rsquo;, &hellip;, x_n&rsquo;)$；则有 $(x_1, x_2, &hellip;, x_n)^T$ 可以通过乘上某一个变换矩阵 $\mathbf{P}$ 转化为 $(x_1&rsquo;, x_2&rsquo;, &hellip;, x_n&rsquo;)$.</p>

<p>从几何意义上来理解，对矩阵的旋转、缩放等等都是一种变换。</p>

<p><strong>线性变换</strong>：满足线性性质的变换，线性性质指的是叠加性（$T(\alpha_1 + \alpha_2) = T(\alpha_1) + T(\alpha_2)$）和齐次性（$T(\lambda \alpha) = \lambda T(\alpha)$）.</p>

<hr />

<p>听起来似乎很复杂的样子，但是上面这些概念，只是对原理中的名词进行解释，可以暂时跳过。</p>

<h2 id="具体步骤">具体步骤</h2>

<h3 id="step-1-找到一组初始的可行解-可行基">STEP 1. 找到一组初始的可行解（可行基）</h3>

<p>单纯形算法的第一步首先要找到一个初始的可行解，那么怎么找呢？以上述线性规划的标准型为例：</p>

<p>$$\max z = x_1 + x_2 (+ 0x_3 + 0x_4)$$
$$s.t. \begin{cases} 2x_1 + x_2 + x_3 = 12 \\ x_1 + 2x_2 + x_4 = 9 \\ x_1, x_2, x_3, x_4 \ge 0 \end{cases}$$</p>

<p>其中松弛变量为 $x_3, x_4$。我们可以将约束和目标函数写成矩阵表示的形式：</p>

<p>$$\max z = \left ( \begin{matrix}1 &amp; 1 &amp; 0 &amp; 0\end{matrix} \right ) \left ( \begin{matrix} x_1 \\x_2 \\ x_3 \\ x_4 \end{matrix} \right ) $$
$$s.t. \left ( \begin{matrix} 2 &amp; 1 &amp; 1 &amp; 0 \\1 &amp; 2 &amp; 0 &amp; 1 \end{matrix} \right ) \left ( \begin{matrix} x_1 \\x_2 \\ x_3 \\x_4 \end{matrix} \right ) = \left ( \begin{matrix} 12 \\ 9 \end{matrix} \right )$$
$$\left ( \begin{matrix}x_1 \\ x_2 \\ x_3 \\ x_4\end{matrix} \right ) \ge 0$$</p>

<p>我们将约束方程写成以下形式：</p>

<p>$$\left ( \begin{matrix} 2 \\ 1 \end{matrix} \right ) x_1 + \left ( \begin{matrix} 1 \\ 2 \end{matrix} \right ) x_2 + \left ( \begin{matrix} 1 \\ 0 \end{matrix} \right ) x_3 + \left ( \begin{matrix} 0 \\ 1 \end{matrix} \right ) x_4 = \left ( \begin{matrix} 12 \\ 9 \end{matrix} \right )$$</p>

<p>$x_3, x_4$ 是我们引入的松弛变量。注意到它们对应的系数列向量<strong>总是线性无关的</strong>，所以对于这种形式我们可以直接取松弛变量作为可行基，即取 $x_3, x_4$ 为一组可行基。可以看出，如果令 $x_1 = 0, x_2 = 0, x_3 = 12, x_4 = 9$，则得到了一组可行解。 <em>// What is this?</em></p>

<p>我们可以列出这样的一张表（称为<strong>单纯形表</strong>）：</p>

<table>
<thead>
<tr>
<th>$x_B$</th>
<th>$b$</th>
<th>$x_1$</th>
<th>$x_2$</th>
<th>$x_3$</th>
<th>$x_4$</th>
<th>$\theta$</th>
</tr>
</thead>

<tbody>
<tr>
<td>$x_3$</td>
<td>12</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>6</td>
</tr>

<tr>
<td>$x_4$</td>
<td>9</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>9</td>
</tr>

<tr>
<td>$z$</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>-</td>
</tr>
</tbody>
</table>

<p>理解一下这张表格。这张表中，左侧的 $x_B$ 表示我们选取的基变量，$b$ 一列则是约束方程右侧的常数；表格中 $x_i$ 列中的内容则为约束方程中对应决策变量的系数；最下面一行 $z$ 表示目标函数中各项决策变量的权重系数以及当前的取值。因为我们选择的初始解为 $(0, 0, 12, 9)$，所以此时 $z=0$.</p>

<h3 id="step-2-寻找更优解">STEP 2. 寻找更优解</h3>

<p>我们的目标函数是 $\max$ 形式，因此我们想要让目标函数尽可能地大。</p>

<p>在上一步当中，我们选择了松弛变量作为初始可行基，<strong>但是显然松弛变量并不会对目标函数 $z$ 产生任何的贡献</strong>，对目标函数产生贡献的变量是其它非基变量（$x_1, x_2$）；而增大 $x_1$ 或 $x_2$ 均可以让目标函数变大，那么我们便从剩余的非基变量 ${x_1, x_2}$ 中，选择若干个个非基变量来替换掉当前的基变量 ${ x_3, x_4 }$，使得目标函数增大同时满足约束。</p>

<p>假设我们想增加 $x_1$，让其成为基变量。因为要让 $z$ 尽可能大，所以 $x_1$ 也要尽可能地大，但是 $x_1$ 仍然受到约束，所以不能够无穷地增大。那么 $x_1$ 最大能增大到多少呢？为此我们考察含有 $x_1$ 的约束等式：</p>

<p>$$2x_1 + x_2 + x_3 = 12$$
$$x_1 + 2x_2 + x_4 = 9$$</p>

<p>为了让 $x_1$ 增大，必须要有其它的基变量减小，来维持等式成立。并且，为了使得 $x_1$ 尽可能大，其它变量就应该尽可能地为它“让路”——即为了让 $x_1$ 最大，则应该让 $x_3$ 或 $x_4$ 的系数减小到 0.</p>

<p>如果让 $x_3$ 的系数减小到 $0$，会让 $x_1$ 增加 $12 / 2 = 6$；让 $x_4$ 的系数减小到 $0$，会让 $x_1$ 增加 $9 / 1 = 9$ （这就是上面的单纯形表中最后一列 $\theta$ 的值）. 我们发现让 $x_4$ 的系数减小到 $0$ 会比让 $x_3$ 的系数减小到 $0$ 时使得 $x_1$ 增加更多。但是，<strong>考虑到我们增大 $x_1$ 的同时要满足所有的约束条件</strong>，所以这里 $x_1$ 只能增大 $\min (6, 9) = 6$。所以我们只能让 $x_3$ 的系数减小到 $0$，此时 $x_3$ 被“换出”基变量成为非基变量，而$x_1$ 成为了基变量。</p>

<p>此时 $x_1$ 已经无法再增加了，因此我们要将约束中的 $x_1$ 的影响减到最小，<strong>只保留增大时用到的等式约束中的 $x_1$， 并把它单位化；然后从其余的等式约束中消去 $x_1$</strong>. 对增广矩阵进行初等行变换：</p>

<p>$$\left( \begin{matrix} 2 &amp; 1 &amp; 1 &amp; 0  &amp;&amp; 12 \\1 &amp; 2 &amp; 0 &amp; 1 &amp;&amp; 9 \end{matrix} \right ) \longrightarrow \left ( \begin{matrix}1 &amp; \frac{1}{2} &amp; \frac{1}{2} &amp; 0 &amp;&amp; 6 \\1 &amp; 2 &amp; 0 &amp; 1 &amp;&amp; 9\end{matrix} \right ) \longrightarrow \left ( \begin{matrix} 1 &amp; \frac{1}{2} &amp; \frac{1}{2} &amp; 0 &amp;&amp; 6 \\ 0 &amp; \frac{3}{2} &amp;  -\frac{1}{2} &amp; 1 &amp;&amp; 3 \end{matrix} \right )$$</p>

<p>同样地，我们也要改变目标函数的形式。将目标函数写到增广矩阵的最后一行，然后对增广矩阵做初等行变换，减去变化的变量 $x_1$ 系数为 1 的那行：</p>

<p>$$\left ( \begin{matrix} 1 &amp; \frac{1}{2} &amp; \frac{1}{2} &amp; 0 &amp;&amp; 6 \\ 0 &amp; \frac{3}{2} &amp;  -\frac{1}{2} &amp; 1 &amp;&amp; 3 \\1 &amp; 1 &amp; 0 &amp; 0 &amp;&amp; z \end{matrix} \right ) \longrightarrow \left ( \begin{matrix}1 &amp; \frac{1}{2} &amp; \frac{1}{2} &amp; 0 &amp;&amp; 6 \\ 0 &amp; \frac{3}{2} &amp;  -\frac{1}{2} &amp; 1 &amp;&amp; 3 \\ 0 &amp; \frac{1}{2} &amp; -\frac{1}{2} &amp; 0 &amp;&amp; z-6 \end{matrix} \right )$$</p>

<p>也就是新的目标函数 $z=\frac{1}{2} x_2 - \frac{1}{2}x_3 + 6$，新的解向量为 $X = (6, 0, 0, 3)^T$.</p>

<p>经过上面的操作之后，我们得到了新的单纯形表：</p>

<table>
<thead>
<tr>
<th>$x_B$</th>
<th>$b$</th>
<th>$x_1$</th>
<th>$x_2$</th>
<th>$x_3$</th>
<th>$x_4$</th>
</tr>
</thead>

<tbody>
<tr>
<td>$x_1$</td>
<td>6</td>
<td>1</td>
<td>$\frac{1}{2}$</td>
<td>$\frac{1}{2}$</td>
<td>0</td>
</tr>

<tr>
<td>$x_4$</td>
<td>3</td>
<td>0</td>
<td>$\frac{3}{2}$</td>
<td>$-\frac{1}{2}$</td>
<td>1</td>
</tr>

<tr>
<td>$z$</td>
<td>-6</td>
<td>0</td>
<td>$\frac{1}{2}$</td>
<td>-$\frac{1}{2}$</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>总结一下上面的操作：</p>

<ul>
<li>找到某个<strong>非基变量 $x_i$</strong>，使得增大 $x_i$ 时能让目标函数增大</li>
<li>对于每一个约束等式，计算 $x_i$ 在满足当前式子的前提下，最大的变化值 $\theta_i = \frac{b_i}{c_i}$, $c_i$ 为当前约束等式中 $x_i$ 的系数</li>
<li>取所有约束等式中， $\theta_i$ 最小的一个约束等式，该等式对应的基变量 $x_B$ 作为换出变量</li>
<li>对于该约束等式，将换入的变量 $x_i$ 单位化，并对增广矩阵使用初等行变换，从其它的约束等式中消去 $x_i$</li>
<li>对目标函数进行变换，得到更优的解</li>
</ul>

<h3 id="step-3-循环迭代上述过程-直到找到最优解">STEP 3. 循环迭代上述过程，直到找到最优解</h3>

<p>在上一步中，我们得到了新的解，但是它可能并不是最优解，所以我们继续迭代上面的过程，直到找到最优解为止。</p>

<p>回忆一下我们上面得到的单纯形表，目标函数变为了 $z = \frac{1}{2}x_2 - \frac{1}{2}x_3 + 6$，现在我们发现<strong>只有增大 $x_2$ 才能使得 $z$ 增大</strong>，所以我们这次选择 $x_2$ 作为换入变量，同时列出单纯形的表格：</p>

<table>
<thead>
<tr>
<th>$x_B$</th>
<th>$b$</th>
<th>$x_1$</th>
<th>$x_2$</th>
<th>$x_3$</th>
<th>$x_4$</th>
<th>$\theta$</th>
</tr>
</thead>

<tbody>
<tr>
<td>$x_1$</td>
<td>6</td>
<td>1</td>
<td>$\frac{1}{2}$</td>
<td>$\frac{1}{2}$</td>
<td>0</td>
<td>12</td>
</tr>

<tr>
<td>$x_4$</td>
<td>3</td>
<td>0</td>
<td>$\frac{3}{2}$</td>
<td>$-\frac{1}{2}$</td>
<td>1</td>
<td>2</td>
</tr>

<tr>
<td>$z$</td>
<td>-6</td>
<td>0</td>
<td>$\frac{1}{2}$</td>
<td>-$\frac{1}{2}$</td>
<td>0</td>
<td>-</td>
</tr>
</tbody>
</table>

<p>仿照上一步的操作，我们应该选择 $\min { 12, 2 } = 2$ 列所对应的基变量 $x_4$ 作为换出变量。对上述矩阵做初等行变换：</p>

<p>$\left ( \begin{matrix} 1 &amp; \frac{1}{2} &amp; \frac{1}{2} &amp; 0  &amp;&amp; 6 \\0 &amp; \frac{3}{2} &amp; -\frac{1}{2} &amp; 1 &amp;&amp; 3 \\0 &amp; \frac{1}{2} &amp; -\frac{1}{2} &amp; 0 &amp;&amp; -6 \end{matrix} \right ) \longrightarrow \left ( \begin{matrix} 1 &amp; \frac{1}{2} &amp; \frac{1}{2} &amp; 0  &amp;&amp; 6 \\0 &amp; 1 &amp; -\frac{1}{3} &amp; \frac{2}{3} &amp;&amp; 2 \\0 &amp; \frac{1}{2} &amp; -\frac{1}{2} &amp; 0 &amp;&amp; -6 \end{matrix} \right )$</p>

<p>$\longrightarrow \left ( \begin{matrix} 1 &amp; 0 &amp; \frac{2}{3} &amp; -\frac{1}{3}  &amp;&amp; 5 \\0 &amp; 1 &amp; -\frac{1}{3} &amp; \frac{2}{3} &amp;&amp; 2 \\0 &amp; 0 &amp; -\frac{1}{3} &amp; -\frac{1}{3} &amp;&amp; -7 \end{matrix} \right )$</p>

<p>此时得到新的单纯形表：</p>

<table>
<thead>
<tr>
<th>$x_B$</th>
<th>$b$</th>
<th>$x_1$</th>
<th>$x_2$</th>
<th>$x_3$</th>
<th>$x_4$</th>
</tr>
</thead>

<tbody>
<tr>
<td>$x_1$</td>
<td>5</td>
<td>1</td>
<td>0</td>
<td>$\frac{2}{3}$</td>
<td>-$\frac{1}{3}$</td>
</tr>

<tr>
<td>$x_2$</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>-$\frac{1}{3}$</td>
<td>$\frac{2}{3}$</td>
</tr>

<tr>
<td>$z$</td>
<td>-7</td>
<td>0</td>
<td>0</td>
<td>-$\frac{1}{3}$</td>
<td>$-\frac{1}{3}$</td>
</tr>
</tbody>
</table>

<p>新的目标函数是：$z = -\frac{1}{3}x_3 - \frac{1}{3}x_4 + 7$，对应解向量 $X = (5, 2, 0, 0)$.</p>

<p>此时的目标函数中变量的系数都为负，无论增大 $x_3$ 或是 $x_4$，都不会使得目标函数的取值变得更大，所以我们的操作结束了，$z_{max} = 7$ 即为最优解。</p>

<h2 id="总结">总结</h2>

<p>到此我们总结一下单纯形法求解线性规划问题的步骤：</p>

<ol>
<li>对于一个线性规划模型的一般形式，通过目标函数取负、增加或改写松弛变量等方式，将线性规划模型标准形式化为具有 $m$ 个变量和 $n$ 个约束条件的形式。</li>
<li>找到一组 $n$ 个基变量（一般选取引入的松弛变量，要求这些基变量在系数矩阵中对应的系数列向量组线性无关），得到初始基和基础解系。</li>
<li>选取非基变量 $x_j$ 代替基变量 $x_k$，这一步会使得 $x_j$ 增大、$x_k$ 减小。考察目标函数 $\max z = \sum_{i=1}^{n} c_ix_i$，为了使得 $z$ 取到最大值，选出的“进基”变量 $x_j$ 的系数应满足 $c_j &gt; 0$，才能满足 $x_j$ 增大时目标函数 $z$ 增大。<strong>如果这一步中有多个 $c_j &gt; 0$</strong>，则选择 $c_j$ 最大的那一个变量。</li>
<li>选取被替代的基变量 $x_k$。首先对于每一个约束等式，计算 $\theta_i = \frac{b}{c_{ij}}$，选择 $\theta_i$ 最小的那一个等式对应的基变量作为“出基”变量。</li>
<li>进行初等行变换，得到新的约束增广矩阵和目标函数。</li>
<li>重复上述步骤，直到 $z$ 中所有变量的系数 $c_i \le 0$ 时，算法结束。</li>
</ol>

<h1 id="代码">代码</h1>

<blockquote>
<p>模板：<a href="http://uoj.ac/problem/179">UOJ #179. 线性规划</a>，这道题多少有点玄学……</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;bits/stdc++.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;

<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> maxn <span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span>, maxm <span style="color:#f92672">=</span> <span style="color:#ae81ff">100050</span>;
<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">double</span> eps <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e-8</span>, inf <span style="color:#f92672">=</span> (<span style="color:#66d9ef">double</span>)(<span style="color:#ae81ff">1ll</span> <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">60</span>);

<span style="color:#66d9ef">int</span> n, m, t, id[maxn <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>];	<span style="color:#75715e">// n: variables, m: constraint
</span><span style="color:#75715e"></span><span style="color:#66d9ef">double</span> a[maxn][maxn], ans[maxn];	<span style="color:#75715e">// a: coefficient matrix
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">void</span> read(T <span style="color:#f92672">&amp;</span>x) {
	T a <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, f <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
	<span style="color:#66d9ef">char</span> ch <span style="color:#f92672">=</span> getchar();
	<span style="color:#66d9ef">while</span> (ch <span style="color:#f92672">&lt;</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">0</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">|</span><span style="color:#f92672">|</span> ch <span style="color:#f92672">&gt;</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">9</span><span style="color:#e6db74">&#39;</span>)
		f <span style="color:#f92672">=</span> ch <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">?</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> f, ch <span style="color:#f92672">=</span> getchar();
	<span style="color:#66d9ef">while</span> (ch <span style="color:#f92672">&gt;</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">0</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> ch <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">9</span><span style="color:#e6db74">&#39;</span>)
		a <span style="color:#f92672">=</span> a <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">+</span> ch <span style="color:#f92672">-</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">0</span><span style="color:#e6db74">&#39;</span>, ch <span style="color:#f92672">=</span> getchar();
	x <span style="color:#f92672">=</span> a <span style="color:#f92672">*</span> f;
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pivot</span>(<span style="color:#66d9ef">int</span> l, <span style="color:#66d9ef">int</span> e) {
	swap(id[n<span style="color:#f92672">+</span>l], id[e]);
	<span style="color:#66d9ef">double</span> tmp <span style="color:#f92672">=</span> a[l][e];
	a[l][e] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
		a[l][j] <span style="color:#f92672">/</span><span style="color:#f92672">=</span> tmp;
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> m; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
		<span style="color:#66d9ef">if</span> (i <span style="color:#f92672">!</span><span style="color:#f92672">=</span> l <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> abs(a[i][e]) <span style="color:#f92672">&gt;</span> eps) {
			tmp <span style="color:#f92672">=</span> a[i][e], a[i][e] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
			<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
				a[i][j] <span style="color:#f92672">-</span><span style="color:#f92672">=</span> a[l][j] <span style="color:#f92672">*</span> tmp;
		}
}

<span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">init</span>() {
	<span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>) {
		<span style="color:#66d9ef">int</span> e <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, l <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> m; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
			<span style="color:#66d9ef">if</span> (a[i][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&lt;</span> <span style="color:#f92672">-</span>eps <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> (<span style="color:#f92672">!</span>l <span style="color:#f92672">|</span><span style="color:#f92672">|</span> (rand() <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>)))
				l <span style="color:#f92672">=</span> i;
		<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>l)
			<span style="color:#66d9ef">break</span>;
		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
			<span style="color:#66d9ef">if</span> (a[l][j] <span style="color:#f92672">&lt;</span> <span style="color:#f92672">-</span>eps <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> (<span style="color:#f92672">!</span>e <span style="color:#f92672">|</span><span style="color:#f92672">|</span> (rand() <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>)))
				e <span style="color:#f92672">=</span> j;
		<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>e) {
			printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Infeasible</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);		<span style="color:#75715e">// 不存在满足约束的解
</span><span style="color:#75715e"></span>			<span style="color:#66d9ef">return</span> false;
		}
		pivot(l, e);
	}
	<span style="color:#66d9ef">return</span> true;
}

<span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">simplex</span>() {
	<span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>) {
		<span style="color:#66d9ef">int</span> l <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, e <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
		<span style="color:#66d9ef">double</span> minv <span style="color:#f92672">=</span> inf;
		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
			<span style="color:#66d9ef">if</span> (a[<span style="color:#ae81ff">0</span>][j] <span style="color:#f92672">&gt;</span> eps) {
				e <span style="color:#f92672">=</span> j;
				<span style="color:#66d9ef">break</span>;
			}
		<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>e)
			<span style="color:#66d9ef">break</span>;
		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> m; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
			<span style="color:#66d9ef">if</span> (a[i][e] <span style="color:#f92672">&gt;</span> eps <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> a[i][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> a[i][e] <span style="color:#f92672">&lt;</span> minv)
				minv <span style="color:#f92672">=</span> a[i][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> a[i][e], l <span style="color:#f92672">=</span> i;
		<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>l) {
			printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Unbounded</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);			<span style="color:#75715e">// 任意解
</span><span style="color:#75715e"></span>			<span style="color:#66d9ef">return</span> false;
		}
		pivot(l, e);
	}
	<span style="color:#66d9ef">return</span> true;
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
	srand(time(NULL));
	read(n), read(m), read(t);
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
		read(a[<span style="color:#ae81ff">0</span>][i]);
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> m; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; j<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
			read(a[i][j]);
		read(a[i][<span style="color:#ae81ff">0</span>]);
	}
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
		id[i] <span style="color:#f92672">=</span> i;
	
	<span style="color:#66d9ef">if</span> (init() <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> simplex()) {
		printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%.8lf</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#f92672">-</span>a[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]);
		<span style="color:#66d9ef">if</span> (t) {
			<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> m; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
				ans[id[n <span style="color:#f92672">+</span> i]] <span style="color:#f92672">=</span> a[i][<span style="color:#ae81ff">0</span>];
			<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> n; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>)
				printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%.8lf </span><span style="color:#e6db74">&#34;</span>, ans[i]);
		}
	}
		
	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div>
<h1 id="ext-对偶原理">Ext: 对偶原理</h1>

<p>假设有这样一个线性规划模型：</p>

<p>$$\max z = \sum_{j=1}^{m} c_jx_j$$</p>

<p>$$s.t. \begin{cases} \sum_{j=1}^m a_{ij}x_j \le b_i, i = 1&hellip;n \\ x_j \ge 0 \end{cases}$$</p>

<p>它的对偶问题是：</p>

<p>$$\min z = \sum_{j=1}^{n} b_ix_i$$
$$s.t. \begin{cases}\sum_{i=1}^{n}c_jix_i \ge c_i, i = 1&hellip;m \\ x_i \ge 0\end{cases}$$</p>

<p>对偶问题与原始问题之间存在着下列关系：
- 目标函数对原始问题是极大化，对对偶问题则是极小化
- 原始问题目标函数中的收益系数是对偶问题约束不等式中的右端常数，而原始问题约束不等式中的右端常数则是对偶问题中目标函数的收益系数
- 原始问题和对偶问题的约束不等式的符号方向相反
- 原始问题约束不等式系数矩阵转置后即为对偶问题的约束不等式的系数矩阵
- 原始问题的约束方程数对应于对偶问题的变量数，而原始问题的变量数对应于对偶问题的约束方程数
- 对偶问题的对偶问题是原始问题，这一性质被称为<strong>原始和对偶问题的对称性</strong></p>

<h1 id="参考文献">参考文献</h1>

<ul>
<li><a href="https://www.cnblogs.com/ECJTUACM-873284962/p/7097864.html">《线性规划之单纯形法【超详解+图解】》</a></li>
<li><a href="https://blog.csdn.net/weixin_43902708/article/details/89253943">《简单易懂的单纯形法理解》</a></li>
</ul>
                    <HR width="100%" id="EOF">
                    <p style="color:#777;">Last modified on 2020-02-11</p>
                </div>
                
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts">
                    Next<br>No newer posts.
                </a>
                
                
                
                <a class="older-posts" href="https://kirainmoe.com/blog/post/opencore-migration-experience/">
                    Previous<br>OpenCore 引导迁移折腾记录
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                
<div class="post-comment-wrapper">
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yume-diary" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>




            </div>
        </div>
    </div>
</div>

            </div><div id="single-column-footer">&copy;
	
	2016-2020 宇宙よりも遠い場所
	

/

<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC-BY-SA 4.0</a>

<br>

Published with <a href="https://gohugo.io">Hugo</a> / Theme <a href="https://github.com/amazingrise/hugo-theme-diary" title="Author: Rise @ amazingrise.net">Diary</a>
</div>
    	</div>
    <script src="https://kirainmoe.com//js/journal.js"></script>
    </body>
</html>
